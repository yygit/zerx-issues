
<!DOCTYPE html>
<html lang="en">
<head>
  <meta id="bb-bootstrap" data-current-user="{&quot;username&quot;: &quot;yybitb&quot;, &quot;displayName&quot;: &quot;yybitb&quot;, &quot;uuid&quot;: &quot;{d2ee9cfe-6807-4b0b-b199-aec6bc17e1c6}&quot;, &quot;firstName&quot;: &quot;yybitb&quot;, &quot;hasPremium&quot;: false, &quot;lastName&quot;: &quot;&quot;, &quot;avatarUrl&quot;: &quot;https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991&quot;, &quot;isTeam&quot;: false, &quot;isSshEnabled&quot;: true, &quot;isKbdShortcutsEnabled&quot;: false, &quot;id&quot;: 2756606, &quot;isAuthenticated&quot;: true}"
data-atlassian-id="557058:50b49aec-0028-4a41-8874-55077e86133c" />
  
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta charset="utf-8">
  <title>
  mst777 / zerx_tv 
  / issues 
  / #689 - Разработать модуль заказов

 &mdash; Bitbucket
</title>
  <script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script>
  



<meta id="bb-canon-url" name="bb-canon-url" content="https://bitbucket.org">
<meta name="bb-api-canon-url" content="https://api.bitbucket.org">
<meta name="apitoken" content="{&quot;token&quot;: &quot;96zdJ3Ap5s_Ni4UNq5RWAmnoHtP267lXQjGYw6CiBJR3Dn8u_1IenogTAkqoSR-JZkU-nfcU5BTKLYMNHT0GhSJj-235-p3wY5F9abFCESomG80=&quot;, &quot;expiration&quot;: 1505383604.427461}">

<meta name="bb-commit-hash" content="4373ea877c7d">
<meta name="bb-app-node" content="app-163">
<meta name="bb-view-name" content="bitbucket.apps.issues.views.issue">
<meta name="ignore-whitespace" content="False">
<meta name="tab-size" content="None">
<meta name="locale" content="en">

<meta name="application-name" content="Bitbucket">
<meta name="apple-mobile-web-app-title" content="Bitbucket">


  
  <meta name="theme-color" content="#0049B0">
  <meta name="msapplication-TileColor" content="#0052CC">
  <meta name="msapplication-TileImage" content="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/logos/bitbucket/mstile-150x150.png">
  <link rel="apple-touch-icon" sizes="180x180" type="image/png" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/logos/bitbucket/apple-touch-icon.png">
  <link rel="icon" sizes="192x192" type="image/png" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/logos/bitbucket/android-chrome-192x192.png">
  <link rel="icon" sizes="16x16 24x24 32x32 64x64" type="image/x-icon" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/logos/bitbucket/favicon_2017.ico">
  <link rel="mask-icon" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/logos/bitbucket/safari-pinned-tab.svg" color="#0052CC">



<link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Bitbucket">

  <meta name="description" content="">
  
  
    
  



  <link rel="stylesheet" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/css/entry/vendor.css" />
<link rel="stylesheet" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/css/entry/app.css" />




  <link rel="stylesheet" href="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/css/entry/adg3.css">

  
  <script nonce="qSJsq9vJwTIhCo24">
  window.__sentry__ = {"dsn": "https://ea49358f525d4019945839a3d7a8292a@sentry.io/159509", "release": "4373ea877c7d (production)", "tags": {"project": "bitbucket-core"}, "environment": "production"};
</script>
<script src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/dist/webpack/sentry.js"></script>
  <script src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/dist/webpack/early.js"></script>
  
  
  
    <link href="/mst777/zerx_tv/rss?token=7c53a8e19608437c17f0f33b3250abd0" rel="alternate nofollow" type="application/rss+xml" title="RSS feed for zerx_tv" />

  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:site" content="@bitbucket"/>
  <meta name="og:type" content="bitbucket:issue"/>
  <meta name="og:title" content="Разработать модуль заказов"/>
  <meta name="og:url" content="https://bitbucket.org/mst777/zerx_tv/issues/689/--------------------------"/>
  
    <meta name="og:description" content="Разработать отдельный модуль, в котором зарегистрированные пользователи могут оставлять заказы на фильмы. Мдераторы берут в исполнение, выполняют и отмечают выполненные заказы.

Каждый заказ имеет несколько статусов:

- Мало голосов (минимум голосов устанавливается в настройках сайта)
- Обрабатывается
- Выполнен (со ссылкой)
- Закрыт правообладателем (не выполнен из-за жалобы)

За заказы можно голосовать только зарегистрированные пользователи. Функция должна быть видна и зарегистрированным и анонимным пользователям. В случае нажатия на кнопку голосования анонимным пользователем - показывать уведомление с сообщением &#34;Для того, чтобы заказать фильм, пожалуйста, зарегистрируйтесь&#34;. Слово *зарегистрируйтесь* должно быть ссылкой-триггером, открывающим окно регистрации.

В панели пользователя должна появиться страница &#34;Мои заказы&#34;, где перечислены заказы пользователя.

Ссылки на страницу стола заказов добавить:

- В сайдбар над &#34;TOP 250 Кинопоиска&#34;;
- На страницу поиска в случае, если ничего не было найдено;
- На страницу пользователя &#34;Мои заказы&#34; слева от заголовка.

Как такогого дизайна стола заказов у нас нет, для начала нужно реализовать механизм стола заказов + минимальная верстка для тестирования утобства. 

---

## Дополнения после обсуждения (12.10.16) ##

### Замечания по валидации формы ###

- Обязательным должно быть только поле с названием, причем либо на английском либо на русском языке. Сейчас ввожу на английском и получаю предупреждение, что нет на русском. (год выхода, соответственно, не обязателен).
- В названии нужно допустить точки, знаки тире, двоеточия. В общем, любые знаки, которые могут встретиться в названии фильма.

### Замечания по действию формы ###

Откуда бы пользователь не добавлял заказ, при успешном добавлении он получит сообщение и 1 ссылку

-  &#34;Просмотреть&#34;. Ведет на на страницу со всеми заказами. Содержит в конце ссылки хештег с номером заказа &#34;http://example.com/orders#order-123&#34;. Заказ с идентификатором, указанным с хештегом - выделяется (фишка bitbucket&#39;a с комментариями)

И кнопка &#34;Выйти&#34;, чтобы закрыть окно.

Если модальное окно вызывается на старнице со списком заказов или на странице со списком заказов пользователя - заказ должен добавиться динамически.

Итого, примерное содержимое окна при успешном добавлении заказа:

```
Ура! Вы добавили заказ. &lt;a&gt;Просмотреть &lt;/a&gt;

&lt;button&gt;Закрыть&lt;/button&gt;

```

### Замечание по голосам при добавлении заказа ###

Когда создается заказ, ему автоматически зачисляется голос того, кто его создал. Тогда пользователю не нужно голосовать за добавленный им же фильм.

### Замечание по жизненному циклу заказа ###

На странице пользователя, у каждого заказа должна быть 1 кнопка: &#34;отозвать голос&#34;. Если человек на нее нажимает, его голос с заказа уходит. При нажатии на эту кнопку, ее содержимое меняется с &#34;Отозвать голос&#34; на &#34;Проголосовать&#34; (на случай, если пользователь отозвал голос случайно).

Также нужно будет добавить скрипт, который удаляет все заказы с количеством голосов равным нулю. Будем запускать раз в сутки и удалять заказы с 0 голосами недельной давности (если у заказа 0 голосов уже неделю).

Получается, я создаю заказ и автоматически голосую за него. У заказа - 1 голос, мой. Если я отзываю голос, то у заказа 0 голосов. Удалить заказ я не могу (но сообщение о том, что если у заказа 0 голосов - он будет удален автоматически, отображается). Если втечение недели кто-то голосует за заказ, заказ не трогаем. Если втечение недели никто за заказ так и не проголосовал - заказ убирается скриптом.

---

## Дополнения 18.10.16 ##

Вот что нужно еще добавить:

Когда пользователь вписывает название фильма в окне добавления заказа, нужно параллельно проводить поиск фильмов с таким же или похожим (другой регистр) названием. Если есть совпадения, выводить под полем с названием список этих фильмов с возможностью проголосовать за них.

1 в 1 функционал как на `kinogo.co`. Попробуй там оставить заказ на фильм, который уже заказан и понаблюдай поведение. В нашем случае, если совпадения есть, то напротив названий фильмов должно быть количество голосов и кнопка голосования.

Например, ты хочешь добавить заказ на &#34;Отряд самоубийц&#34;. Вводишь название фильма в поле и через мгновение под этим полем выпадает список с фильмами с похожим названием. Ты видишь, что такой заказ уже есть, смотришь, какой заказ набрал больше голосов и голосуешь за него, чтобы побыстрее выполнили твой заказ. Закрываешь окно."/>
  
  
    <meta name="og:image" content="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/repo-avatars/default.svg"/>
  

</head>
<body class="production adg3 "
    data-static-url="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/"
data-base-url="https://bitbucket.org"
data-no-avatar-image="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/default_avatar/user_blue.svg"
data-current-user="{&quot;username&quot;: &quot;yybitb&quot;, &quot;displayName&quot;: &quot;yybitb&quot;, &quot;uuid&quot;: &quot;{d2ee9cfe-6807-4b0b-b199-aec6bc17e1c6}&quot;, &quot;firstName&quot;: &quot;yybitb&quot;, &quot;hasPremium&quot;: false, &quot;lastName&quot;: &quot;&quot;, &quot;avatarUrl&quot;: &quot;https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991&quot;, &quot;isTeam&quot;: false, &quot;isSshEnabled&quot;: true, &quot;isKbdShortcutsEnabled&quot;: false, &quot;id&quot;: 2756606, &quot;isAuthenticated&quot;: true}"
data-atlassian-id="{&quot;loginStatusUrl&quot;: &quot;https://id.atlassian.com/profile/rest/profile&quot;}"
data-settings="{&quot;MENTIONS_MIN_QUERY_LENGTH&quot;: 3}"

data-current-repo="{&quot;scm&quot;: &quot;git&quot;, &quot;readOnly&quot;: false, &quot;mainbranch&quot;: {&quot;name&quot;: &quot;master&quot;}, &quot;language&quot;: &quot;&quot;, &quot;owner&quot;: {&quot;username&quot;: &quot;mst777&quot;, &quot;uuid&quot;: &quot;102fbc9b-6b05-444d-b783-fe5fbf7c8001&quot;, &quot;isTeam&quot;: false}, &quot;fullslug&quot;: &quot;mst777/zerx_tv&quot;, &quot;slug&quot;: &quot;zerx_tv&quot;, &quot;id&quot;: 10268036, &quot;pygmentsLanguage&quot;: null}"






data-browser-monitoring="true"
data-switch-create-pullrequest-commit-status="true"


data-atlassian-editor-enabled="true"
data-atlassian-emoji-base-url="https://pf-emoji-service.atlassian.io/emoji/"
>
<div id="page">
  
    
      <div id="adg3-navigation"
  
  
  
  <nav class="skeleton-nav">
    <div class="skeleton-nav--left">
      <div class="skeleton-nav--left-top">
        <ul class="skeleton-nav--items">
          <li></li>
          <li></li>
          <li></li>
          <li class="skeleton--icon"></li>
          <li class="skeleton--icon-sub"></li>
          <li class="skeleton--icon-sub"></li>
          <li class="skeleton--icon-sub"></li>
          <li class="skeleton--icon-sub"></li>
          <li class="skeleton--icon-sub"></li>
          <li class="skeleton--icon-sub"></li>
        </ul>
      </div>
      <div class="skeleton-nav--left-bottom">
        <div class="skeleton-nav--left-bottom-wrapper">
          <div class="skeleton-nav--item-help"></div>
          <div class="skeleton-nav--item-profile"></div>
        </div>
      </div>
    </div>
    <div class="skeleton-nav--right">
      <ul class="skeleton-nav--items-wide">
        <li class="skeleton--icon-logo-container">
          <div class="skeleton--icon-container"></div>
          <div class="skeleton--icon-description"></div>
          <div class="skeleton--icon-logo"></div>
        </li>
        <li>
          <div class="skeleton--icon-small"></div>
          <div class="skeleton-nav--item-wide-content"></div>
        </li>
        <li>
          <div class="skeleton--icon-small"></div>
          <div class="skeleton-nav--item-wide-content"></div>
        </li>
        <li>
          <div class="skeleton--icon-small"></div>
          <div class="skeleton-nav--item-wide-content"></div>
        </li>
        <li>
          <div class="skeleton--icon-small"></div>
          <div class="skeleton-nav--item-wide-content"></div>
        </li>
        <li>
          <div class="skeleton--icon-small"></div>
          <div class="skeleton-nav--item-wide-content"></div>
        </li>
        <li>
          <div class="skeleton--icon-small"></div>
          <div class="skeleton-nav--item-wide-content"></div>
        </li>
      </ul>
    </div>
  </nav>
</div>


    
    <div id="wrapper">
      
  
  


      

      
  
    <div id="nps-survey-container"></div>
  


      
  

<div id="account-warning" data-module="header/account-warning"
  data-unconfirmed-addresses="false"
  data-no-addresses="false"
  
></div>



      
  
<header id="aui-message-bar">
  
</header>


    <div id="content" role="main">
      
        
          <header class="app-header">
            <div class="app-header--primary">
              
                <div class="app-header--context">
                  <div class="app-header--breadcrumbs">
                    
            <ol class="aui-nav aui-nav-breadcrumbs">
              <li>
  <a href="/mst777/">DiMaco mb</a>
</li>

<li>
  <a href="/mst777/zerx_tv">zerx_tv</a>
</li>
              
  <li>
    <a href="/mst777/zerx_tv/issues?status=new&amp;status=open">
      Issues
    </a>
  </li>

            </ol>
          
                  </div>
                  <h1 class="app-header--heading">
                    Issues
                  </h1>
                </div>
                
              </div>
              <div class="app-header--secondary">
                
                  
    
  
    <a id="create-issue-contextual" href="/mst777/zerx_tv/issues/new"
        class="aui-button">
      
      <span class="aui-button-label">Create issue</span>
    </a>
  

                
              </div>
            </header>
          
        
        
  

        
  <div class="aui-page-panel ">
    <div class="hidden">
  
  </div>
    <div class="aui-page-panel-inner">

      <div
        id="repo-content"
        class="aui-page-panel-content forks-enabled can-create"
        data-module="repo/index"
        
      >
        
        
        
  <div id="issues" class="clearfix">
    
  
  <section id="issue-view" class=""
      data-id="17443657"
      data-local-id="689"
      data-status="8">
    <div id="issue-header" class="clearfix">
      <span class="issue-id">
        
          Issue #689
        
      </span>
      <a href="/mst777/zerx_tv/issues?status=closed">
        <span class="aui-lozenge aui-lozenge-success">closed</span>
      </a>
      
        <div class="issue-toolbar">
          
            <div id="workflow-dropdown" class="aui-dropdown2 aui-style-default">
              <ul>
                <li data-transition-to="1" title="Mark as new"><a>new</a></li>
                <li data-transition-to="2" title="Open issue"><a>open</a></li>
                <li data-transition-to="4" title="Put on hold"><a>on hold</a></li>
                <li data-transition-to="3" title="Resolve issue"><a>resolved</a></li>
                <li data-transition-to="6" title="Mark as duplicate"><a>duplicate</a></li>
                <li data-transition-to="5" title="Mark as invalid"><a>invalid</a></li>
                <li data-transition-to="7" title="Mark as wontfix"><a>wontfix</a></li>
                <li data-transition-to="8" title="Close issue"><a>closed</a></li>
              </ul>
            </div>
            
    
    
  
            
    
    
  
            <div id="issue-actions" class="aui-buttons">
              
                <a id="change-state" class="aui-button aui-button-primary" data-transition-to="2" href="#reopen" title="Open issue">
                  Open
                </a>
              
              <a href="#workflow" id="workflow" class="aui-button aui-dropdown2-trigger"
                  aria-owns="workflow-dropdown" aria-haspopup="true">
                <span class="dropdown-text">Workflow</span>
              </a>
            </div>
          
          
            <div class="aui-buttons">
              <a href="#attach" class="issue-attach-link aui-button">
                Attach
              </a>
            </div>
          
          
            <div class="aui-buttons">
              <a href="/mst777/zerx_tv/issues/edit/689" id="edit-issue" class="aui-button">Edit</a>
            </div>
          
          
        </div>
        
    
    
  
      
    </div>
    <div class="aui-group">
      <div class="aui-item">
        <div id="issue-main-content">
          <h1 id="issue-title">Разработать модуль заказов</h1>

          <div class="issue-author">
            
              


  
    <a href="/icamys/" title="Dmitrii Prisacari">
      <div class="aui-avatar aui-avatar-medium">
        <div class="aui-avatar-inner">
          <img src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/img/default_avatar/user_blue.svg" class="deferred-image"
              data-src-url="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342"
              data-src-url-2x="https://bitbucket.org/account/icamys/avatar/64/?ts=1505378342" alt="">
        </div>
      </div>
  
      <span title="Dmitrii Prisacari">Dmitrii Prisacari</span>
  
    </a>
  

            
            
            
            created an issue
            <time datetime="2016-09-25T19:15:38.400814+00:00">2016-09-25</time>
          </div>
          <div class="issue-description wiki-content">
            
              <p>Разработать отдельный модуль, в котором зарегистрированные пользователи могут оставлять заказы на фильмы. Мдераторы берут в исполнение, выполняют и отмечают выполненные заказы.</p>
<p>Каждый заказ имеет несколько статусов:</p>
<ul>
<li>Мало голосов (минимум голосов устанавливается в настройках сайта)</li>
<li>Обрабатывается</li>
<li>Выполнен (со ссылкой)</li>
<li>Закрыт правообладателем (не выполнен из-за жалобы)</li>
</ul>
<p>За заказы можно голосовать только зарегистрированные пользователи. Функция должна быть видна и зарегистрированным и анонимным пользователям. В случае нажатия на кнопку голосования анонимным пользователем - показывать уведомление с сообщением "Для того, чтобы заказать фильм, пожалуйста, зарегистрируйтесь". Слово <em>зарегистрируйтесь</em> должно быть ссылкой-триггером, открывающим окно регистрации.</p>
<p>В панели пользователя должна появиться страница "Мои заказы", где перечислены заказы пользователя.</p>
<p>Ссылки на страницу стола заказов добавить:</p>
<ul>
<li>В сайдбар над "TOP 250 Кинопоиска";</li>
<li>На страницу поиска в случае, если ничего не было найдено;</li>
<li>На страницу пользователя "Мои заказы" слева от заголовка.</li>
</ul>
<p>Как такогого дизайна стола заказов у нас нет, для начала нужно реализовать механизм стола заказов + минимальная верстка для тестирования утобства. </p>
<hr />
<h2 id="markdown-header-121016">Дополнения после обсуждения (12.10.16)</h2>
<h3 id="markdown-header-">Замечания по валидации формы</h3>
<ul>
<li>Обязательным должно быть только поле с названием, причем либо на английском либо на русском языке. Сейчас ввожу на английском и получаю предупреждение, что нет на русском. (год выхода, соответственно, не обязателен).</li>
<li>В названии нужно допустить точки, знаки тире, двоеточия. В общем, любые знаки, которые могут встретиться в названии фильма.</li>
</ul>
<h3 id="markdown-header-_1">Замечания по действию формы</h3>
<p>Откуда бы пользователь не добавлял заказ, при успешном добавлении он получит сообщение и 1 ссылку</p>
<ul>
<li>"Просмотреть". Ведет на на страницу со всеми заказами. Содержит в конце ссылки хештег с номером заказа "<a href="http://example.com/orders#order-123" rel="nofollow">http://example.com/orders#order-123</a>". Заказ с идентификатором, указанным с хештегом - выделяется (фишка bitbucket'a с комментариями)</li>
</ul>
<p>И кнопка "Выйти", чтобы закрыть окно.</p>
<p>Если модальное окно вызывается на старнице со списком заказов или на странице со списком заказов пользователя - заказ должен добавиться динамически.</p>
<p>Итого, примерное содержимое окна при успешном добавлении заказа:</p>
<div class="codehilite"><pre><span></span>Ура! Вы добавили заказ. <span class="nt">&lt;a&gt;</span>Просмотреть <span class="nt">&lt;/a&gt;</span>

<span class="nt">&lt;button&gt;</span>Закрыть<span class="nt">&lt;/button&gt;</span>
</pre></div>


<h3 id="markdown-header-_2">Замечание по голосам при добавлении заказа</h3>
<p>Когда создается заказ, ему автоматически зачисляется голос того, кто его создал. Тогда пользователю не нужно голосовать за добавленный им же фильм.</p>
<h3 id="markdown-header-_3">Замечание по жизненному циклу заказа</h3>
<p>На странице пользователя, у каждого заказа должна быть 1 кнопка: "отозвать голос". Если человек на нее нажимает, его голос с заказа уходит. При нажатии на эту кнопку, ее содержимое меняется с "Отозвать голос" на "Проголосовать" (на случай, если пользователь отозвал голос случайно).</p>
<p>Также нужно будет добавить скрипт, который удаляет все заказы с количеством голосов равным нулю. Будем запускать раз в сутки и удалять заказы с 0 голосами недельной давности (если у заказа 0 голосов уже неделю).</p>
<p>Получается, я создаю заказ и автоматически голосую за него. У заказа - 1 голос, мой. Если я отзываю голос, то у заказа 0 голосов. Удалить заказ я не могу (но сообщение о том, что если у заказа 0 голосов - он будет удален автоматически, отображается). Если втечение недели кто-то голосует за заказ, заказ не трогаем. Если втечение недели никто за заказ так и не проголосовал - заказ убирается скриптом.</p>
<hr />
<h2 id="markdown-header-181016">Дополнения 18.10.16</h2>
<p>Вот что нужно еще добавить:</p>
<p>Когда пользователь вписывает название фильма в окне добавления заказа, нужно параллельно проводить поиск фильмов с таким же или похожим (другой регистр) названием. Если есть совпадения, выводить под полем с названием список этих фильмов с возможностью проголосовать за них.</p>
<p>1 в 1 функционал как на <code>kinogo.co</code>. Попробуй там оставить заказ на фильм, который уже заказан и понаблюдай поведение. В нашем случае, если совпадения есть, то напротив названий фильмов должно быть количество голосов и кнопка голосования.</p>
<p>Например, ты хочешь добавить заказ на "Отряд самоубийц". Вводишь название фильма в поле и через мгновение под этим полем выпадает список с фильмами с похожим названием. Ты видишь, что такой заказ уже есть, смотришь, какой заказ набрал больше голосов и голосуешь за него, чтобы побыстрее выполнили твой заказ. Закрываешь окно.</p>
            
          </div>

          <div class="attachments" id="attachments">
            
          </div>
        </div>

        <div id="issues-comments-container">
          

          <h2>
            
              Comments (22)
            
          </h2>
          <ol id="issues-comments" class="comments-list commentable">
            
              <li class="issue-comment comment" id="comment-30871576">
                
                 

<article id="comment-30871576" class="iterable-item"
         data-comment-id="30871576"
         data-convert-markup="False"
         
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
              edited description
      </li>
  </ul>
  <div class="wiki-content comment-content">
    
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-30871576" title="Link directly to this comment">
        <time datetime="2016-09-25T19:16:08+00:00" data-title="true">2016-09-25T19:16:08+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31063702">
                
                 

<article id="comment-31063702" class="iterable-item"
         data-comment-id="31063702"
         data-convert-markup="False"
         
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
              edited description
      </li>
  </ul>
  <div class="wiki-content comment-content">
    
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31063702" title="Link directly to this comment">
        <time datetime="2016-10-03T12:52:19+00:00" data-title="true">2016-10-03T12:52:19+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31064222">
                
                 

<article id="comment-31064222" class="iterable-item"
         data-comment-id="31064222"
         data-convert-markup="False"
         
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
              edited description
      </li>
      <li>
              assigned issue to
                  <a href="/mst777/zerx_tv/issues?responsible=yybitb" title="yybitb">
                    <div class="aui-avatar aui-avatar-xsmall">
                      <div class="aui-avatar-inner">
                        <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
                      </div>
                    </div>
                    <span>yybitb</span>
                  </a>
      </li>
  </ul>
  <div class="wiki-content comment-content">
    
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31064222" title="Link directly to this comment">
        <time datetime="2016-10-03T13:11:56+00:00" data-title="true">2016-10-03T13:11:56+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31294090">
                
                 

<article id="comment-31294090" class="iterable-item"
         data-comment-id="31294090"
         data-convert-markup="False"
         data-content="Последний комит  на данный момент - cd09eec . Выполнено с минимальной версткой для тестирования функционала **добавления** заказов и **голосования** по заказам. 

1) добавлено 2 таблицы - `order_desk` для хранения заказов и `order_desk_votes` для хранения голосов по заказам . Таблицы добавляются в базу через миграции: 

```
#!text

cd /vagrant
php script/migration/launcher.php
```

2) Настройка &quot;**Мин. кол-во голосов**&quot; добавлена в последнюю вкладку меню &quot;Настройки системы&quot; админ. панели . Если этот параметр не выставлен, действует \Models\Orders::MIN_ORDER_VOTES . Проверка по этому параметру происходит при попытке выставить статусы заказов &quot;Обрабатывается&quot; или &quot;Выполнен&quot;. Если реальное кол-во голосов меньше - выдается ошибка. "
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Последний комит  на данный момент - <a href="/mst777/zerx_tv/commits/cd09eec" rel="nofollow">cd09eec</a> . Выполнено с минимальной версткой для тестирования функционала <strong>добавления</strong> заказов и <strong>голосования</strong> по заказам. </p>
<p>1) добавлено 2 таблицы - <code>order_desk</code> для хранения заказов и <code>order_desk_votes</code> для хранения голосов по заказам . Таблицы добавляются в базу через миграции: </p>
<div class="codehilite language-text"><pre><span></span>cd /vagrant
php script/migration/launcher.php
</pre></div>


<p>2) Настройка "<strong>Мин. кол-во голосов</strong>" добавлена в последнюю вкладку меню "Настройки системы" админ. панели . Если этот параметр не выставлен, действует \Models\Orders::MIN_ORDER_VOTES . Проверка по этому параметру происходит при попытке выставить статусы заказов "Обрабатывается" или "Выполнен". Если реальное кол-во голосов меньше - выдается ошибка. </p>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31294090">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31294090" title="Link directly to this comment">
        <time datetime="2016-10-12T06:42:20+00:00" data-title="true">2016-10-12T06:42:20+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31300144">
                
                 

<article id="comment-31300144" class="iterable-item"
         data-comment-id="31300144"
         data-convert-markup="False"
         
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
              edited description
      </li>
  </ul>
  <div class="wiki-content comment-content">
    
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31300144" title="Link directly to this comment">
        <time datetime="2016-10-12T10:13:11+00:00" data-title="true">2016-10-12T10:13:11+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31301097">
                
                 

<article id="comment-31301097" class="iterable-item"
         data-comment-id="31301097"
         data-convert-markup="False"
         data-content="Для выделения заказа не нужно добавлять никаких дополнительных классов. Все будет делаться через CSS."
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Для выделения заказа не нужно добавлять никаких дополнительных классов. Все будет делаться через CSS.</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31301097" title="Link directly to this comment">
        <time datetime="2016-10-12T10:42:01+00:00" data-title="true">2016-10-12T10:42:01+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31360392">
                
                 

<article id="comment-31360392" class="iterable-item"
         data-comment-id="31360392"
         data-convert-markup="False"
         data-content="Последний комит по правкам блока &quot;Дополнения после обсуждения (12.10.16)&quot; - 2a45d7f9807

Запуск **скрипта чистки старых непроголосованных заказов**:

```
#!text

cd /vagrant
php script/cron/orders-delete-old.php --verbose --limit=100
```
"
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Последний комит по правкам блока "Дополнения после обсуждения (12.10.16)" - <a href="/mst777/zerx_tv/commits/2a45d7f9807" rel="nofollow">2a45d7f9807</a></p>
<p>Запуск <strong>скрипта чистки старых непроголосованных заказов</strong>:</p>
<div class="codehilite language-text"><pre><span></span>cd /vagrant
php script/cron/orders-delete-old.php --verbose --limit=100
</pre></div>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31360392">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31360392" title="Link directly to this comment">
        <time datetime="2016-10-14T09:27:37+00:00" data-title="true">2016-10-14T09:27:37+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31400013">
                
                 

<article id="comment-31400013" class="iterable-item"
         data-comment-id="31400013"
         data-convert-markup="False"
         data-content="&gt; должна быть 1 кнопка: &quot;отозвать голос&quot;. Если человек на нее нажимает, его голос с заказа уходит. При нажатии на эту кнопку, ее содержимое меняется с &quot;Отозвать голос&quot; на &quot;Проголосовать&quot; (на случай, если пользователь отозвал голос случайно).

\- вызов двух модальных окон: одно при голосовании, другое при отзыве голоса - лишнее.

---

&gt; Обязательным должно быть только поле с названием

Сейчас указание жанра все еще обязательно.

---

&gt; Ссылки на страницу стола заказов добавить:

&gt; - В сайдбар над &quot;TOP 250 Кинопоиска&quot;;
&gt; - ...

Сейчас ссылка в сайдбар вызывает модальное окно добавления заказа."
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <blockquote>
<p>должна быть 1 кнопка: "отозвать голос". Если человек на нее нажимает, его голос с заказа уходит. При нажатии на эту кнопку, ее содержимое меняется с "Отозвать голос" на "Проголосовать" (на случай, если пользователь отозвал голос случайно).</p>
</blockquote>
<p>- вызов двух модальных окон: одно при голосовании, другое при отзыве голоса - лишнее.</p>
<hr />
<blockquote>
<p>Обязательным должно быть только поле с названием</p>
</blockquote>
<p>Сейчас указание жанра все еще обязательно.</p>
<hr />
<blockquote>
<p>Ссылки на страницу стола заказов добавить:</p>
<ul>
<li>В сайдбар над "TOP 250 Кинопоиска";</li>
<li>...</li>
</ul>
</blockquote>
<p>Сейчас ссылка в сайдбар вызывает модальное окно добавления заказа.</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31400013" title="Link directly to this comment">
        <time datetime="2016-10-16T18:53:06+00:00" data-title="true">2016-10-16T18:53:06+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31464448">
                
                 

<article id="comment-31464448" class="iterable-item"
         data-comment-id="31464448"
         data-convert-markup="False"
         
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
              edited description
      </li>
  </ul>
  <div class="wiki-content comment-content">
    
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31464448" title="Link directly to this comment">
        <time datetime="2016-10-18T14:14:56+00:00" data-title="true">2016-10-18T14:14:56+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31464458">
                
                 

<article id="comment-31464458" class="iterable-item"
         data-comment-id="31464458"
         data-convert-markup="False"
         
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
              edited description
      </li>
  </ul>
  <div class="wiki-content comment-content">
    
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31464458" title="Link directly to this comment">
        <time datetime="2016-10-18T14:15:16+00:00" data-title="true">2016-10-18T14:15:16+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31514594">
                
                 

<article id="comment-31514594" class="iterable-item"
         data-comment-id="31514594"
         data-convert-markup="False"
         data-content="Правки по &quot;Дополнения 18.10.16&quot; - комит 1fb2529887b5 

В миграцию по табл `order_desk` добавил **полнотекстовый индекс** для поиска похожих заказов, отдельную миграцию под него не делал. Чтобы добавить индекс в таблицы заказов  с уже существующими данными, нужно выполнить следующий SQL:

```
#!sql

-- ----------------------------
--  add FULL TEXT index  
-- ----------------------------
ALTER TABLE `order_desk` ADD FULLTEXT INDEX `fti_runame_enname` (`runame`, `enname`);

```

Либо удалить 2 табл. заказов (`order_desk_votes`, `order_desk`) если они есть и запустить миграции из CLI заново."
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Правки по "Дополнения 18.10.16" - комит <a href="/mst777/zerx_tv/commits/1fb2529887b5" rel="nofollow">1fb2529887b5</a> </p>
<p>В миграцию по табл <code>order_desk</code> добавил <strong>полнотекстовый индекс</strong> для поиска похожих заказов, отдельную миграцию под него не делал. Чтобы добавить индекс в таблицы заказов  с уже существующими данными, нужно выполнить следующий SQL:</p>
<div class="codehilite language-sql"><pre><span></span><span class="c1">-- ----------------------------</span>
<span class="c1">--  add FULL TEXT index  </span>
<span class="c1">-- ----------------------------</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">order_desk</span><span class="o">`</span> <span class="k">ADD</span> <span class="n">FULLTEXT</span> <span class="k">INDEX</span> <span class="o">`</span><span class="n">fti_runame_enname</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">runame</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">enname</span><span class="o">`</span><span class="p">);</span>
</pre></div>


<p>Либо удалить 2 табл. заказов (<code>order_desk_votes</code>, <code>order_desk</code>) если они есть и запустить миграции из CLI заново.</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31514594">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31514594" title="Link directly to this comment">
        <time datetime="2016-10-20T06:23:04+00:00" data-title="true">2016-10-20T06:23:04+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31528059">
                
                 

<article id="comment-31528059" class="iterable-item"
         data-comment-id="31528059"
         data-convert-markup="False"
         data-content="комит 0bb2ef6

```
#!text

Юр, по поводу модуля заказов: нужно внести пару и поправок в самом коде. Это уже 
больше рефакторинг.
В последних обновлениях в ветке с задачей я перенес все логически связанные 
шаблоны в отдельные, выделенные для них директории. После этого, логично будет 
сделать следующее:

1. Все модальные окна, связанные со столом заказов, перенести в 
web/views/site/modules/orders, так как эти окна принадлежат только этому модулю.

2. Из верстки стола заказов убрать все упоминания о классах профиля 
пользователя 'c-user-profile'. Сейчас в модуле стола заказов почему-то встречаются 
классы другого модуля.

3. Шаблон со столом заказов нужно вынести в отедельный файл, который будет 
содержать действия, которые можно совершить со столом заказов, список заказов и 
модальные окна. Если это сделать, будет удобно подключать этот шаблон как на 
страницу модуля &quot;Стол заказов&quot;, так и на страницу профиля пользователя.

В итоге, должен получиться файл с содержимым типа:

.c-order-table
    .c-order-table__actions
        .c-order_table__action--&lt;action title&gt;
    .c-order-table__list
    .c-order-table__modal-&lt;modal action 1&gt;
    .c-order-table__modal-&lt;modal action 2&gt;
    ...

Этот файл должен включаться на страницу модуля стола заказов и страницу 
профиля пользователя.

4. Для этого модуля должен быть написан отдельный файл с js компонентом. 
Желательно отказываться от модели, где используются хуки. Это раньше было 
удобно, потому что код JS писал я, а связывал его с версткой не я. Сейчас же лучше 
писать монолитный код для одного модуля, который не будет разбросан по 
нескольким файлам. Фактически нужно сделать манипуляции с именованиями, 
затем перенести код в один файл.
```
"
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>комит <a href="/mst777/zerx_tv/commits/0bb2ef6" rel="nofollow">0bb2ef6</a></p>
<div class="codehilite language-text"><pre><span></span>Юр, по поводу модуля заказов: нужно внести пару и поправок в самом коде. Это уже 
больше рефакторинг.
В последних обновлениях в ветке с задачей я перенес все логически связанные 
шаблоны в отдельные, выделенные для них директории. После этого, логично будет 
сделать следующее:

1. Все модальные окна, связанные со столом заказов, перенести в 
web/views/site/modules/orders, так как эти окна принадлежат только этому модулю.

2. Из верстки стола заказов убрать все упоминания о классах профиля 
пользователя &#39;c-user-profile&#39;. Сейчас в модуле стола заказов почему-то встречаются 
классы другого модуля.

3. Шаблон со столом заказов нужно вынести в отедельный файл, который будет 
содержать действия, которые можно совершить со столом заказов, список заказов и 
модальные окна. Если это сделать, будет удобно подключать этот шаблон как на 
страницу модуля &quot;Стол заказов&quot;, так и на страницу профиля пользователя.

В итоге, должен получиться файл с содержимым типа:

.c-order-table
    .c-order-table__actions
        .c-order_table__action--&lt;action title&gt;
    .c-order-table__list
    .c-order-table__modal-&lt;modal action 1&gt;
    .c-order-table__modal-&lt;modal action 2&gt;
    ...

Этот файл должен включаться на страницу модуля стола заказов и страницу 
профиля пользователя.

4. Для этого модуля должен быть написан отдельный файл с js компонентом. 
Желательно отказываться от модели, где используются хуки. Это раньше было 
удобно, потому что код JS писал я, а связывал его с версткой не я. Сейчас же лучше 
писать монолитный код для одного модуля, который не будет разбросан по 
нескольким файлам. Фактически нужно сделать манипуляции с именованиями, 
затем перенести код в один файл.
</pre></div>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31528059">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31528059" title="Link directly to this comment">
        <time datetime="2016-10-20T13:26:33+00:00" data-title="true">2016-10-20T13:26:33+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31598808">
                
                 

<article id="comment-31598808" class="iterable-item"
         data-comment-id="31598808"
         data-convert-markup="False"
         data-content="В обновлении 0bb2ef6 нашел ряд дефектов:

1. В модальном окне заказа неактуальная информация. Путь воспроизведения:
    - Создаю заказ фильма &quot;Игра престолов&quot;;
    - В появившемся заказе убираю мой *единственный* голос;
    - На той же странице снова создаю заказ фильма &quot;Игра престолов&quot;. В модальном окне выпадает список с уже созданным заказом. Возле созданного заказа стоит 1 голос, хотя ожидается 0 голосов.

2. В админ. панели не удается сменить статус заказа.

Параллельно с исправлением этих дефектов следует добавить различные тесты UI, которые должны вызываться в виртуальной машине.

Итого, предлагаю следующие действия:

1. Выполнить задачу #702 и слить ее в текущую ветку.
2. Добавить новые тесты для модуля заказов в директории `tests/site/php/modules` и `tests/backoffice/php/modules`.

Тесты должны покрывать весь функционал, описанный ранее в задаче, чтобы любые дефекты поведения можно было быстро обнаружить."
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>В обновлении <a href="/mst777/zerx_tv/commits/0bb2ef6" rel="nofollow">0bb2ef6</a> нашел ряд дефектов:</p>
<ol>
<li>
<p>В модальном окне заказа неактуальная информация. Путь воспроизведения:</p>
<ul>
<li>Создаю заказ фильма "Игра престолов";</li>
<li>В появившемся заказе убираю мой <em>единственный</em> голос;</li>
<li>На той же странице снова создаю заказ фильма "Игра престолов". В модальном окне выпадает список с уже созданным заказом. Возле созданного заказа стоит 1 голос, хотя ожидается 0 голосов.</li>
</ul>
</li>
<li>
<p>В админ. панели не удается сменить статус заказа.</p>
</li>
</ol>
<p>Параллельно с исправлением этих дефектов следует добавить различные тесты UI, которые должны вызываться в виртуальной машине.</p>
<p>Итого, предлагаю следующие действия:</p>
<ol>
<li>Выполнить задачу <a href="/mst777/zerx_tv/issues/702/php" rel="nofollow" title="Отладить PHP тесты для виртуальной машины"><s>#702</s></a> и слить ее в текущую ветку.</li>
<li>Добавить новые тесты для модуля заказов в директории <code>tests/site/php/modules</code> и <code>tests/backoffice/php/modules</code>.</li>
</ol>
<p>Тесты должны покрывать весь функционал, описанный ранее в задаче, чтобы любые дефекты поведения можно было быстро обнаружить.</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-31598808" title="Link directly to this comment">
        <time datetime="2016-10-24T09:10:11+00:00" data-title="true">2016-10-24T09:10:11+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31864485">
                
                 

<article id="comment-31864485" class="iterable-item"
         data-comment-id="31864485"
         data-convert-markup="False"
         data-content="Комит b6a6f62 - **юнит** тест для модуля Заказов

Запуск на виртуальной машине :

```
#!text

cd /vagrant
./vendor/phpunit/phpunit/phpunit tests/site/php/modules/OrdersTest.php
```

и результат:


```
#!text
....SS....SS    12 / 12 (100%)
Time: 560 ms, Memory: 6.00MB
OK, but incomplete, skipped, or risky tests!
Tests: 13, Assertions: 86, Skipped: 4.
```

Пропущенные тесты - создание и изменение записей невалидными данными используя общие дата-провайдеры. Невалидные данные используются для проверки правильности валидации модели. "
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Комит <a href="/mst777/zerx_tv/commits/b6a6f62" rel="nofollow">b6a6f62</a> - <strong>юнит</strong> тест для модуля Заказов</p>
<p>Запуск на виртуальной машине :</p>
<div class="codehilite language-text"><pre><span></span>cd /vagrant
./vendor/phpunit/phpunit/phpunit tests/site/php/modules/OrdersTest.php
</pre></div>


<p>и результат:</p>
<div class="codehilite language-text"><pre><span></span>....SS....SS    12 / 12 (100%)
Time: 560 ms, Memory: 6.00MB
OK, but incomplete, skipped, or risky tests!
Tests: 13, Assertions: 86, Skipped: 4.
</pre></div>


<p>Пропущенные тесты - создание и изменение записей невалидными данными используя общие дата-провайдеры. Невалидные данные используются для проверки правильности валидации модели. </p>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31864485">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31864485" title="Link directly to this comment">
        <time datetime="2016-11-02T21:50:53+00:00" data-title="true">2016-11-02T21:50:53+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31942261">
                
                 

<article id="comment-31942261" class="iterable-item"
         data-comment-id="31942261"
         data-convert-markup="False"
         data-content="Комит 0e59eda - **Functional** тесты со стороны витрины

Запуск на виртуальной машине :

```
#!text

cd /vagrant
./vendor/phpunit/phpunit/phpunit tests/site/php/functional/orders/OrdersFunctionalTest.php
```

и результат:

```
#!text
Time: 2.01 minutes, Memory: 12.00MB
OK (4 tests, 141 assertions)
```

Тест \OrdersFunctionalTest::**testProfilePageVotingNonAuth**  имеет костыль. Запуск на VM (selenium + Firefox) видимо игнорирует все вызовы `focus()`. Поэтому невозможно снятие фокуса с поля Название (например при фокусе на поле Год) при нахождении похожих заказов и соответственно нормальное срабатывание события `on('focusout')`. В web/assets/site/scripts/components/c-order-table.js:252 был вынужден повесить дополнительный хендлер на клик по полю Год исключительно для теста по похожим заказам. Запуск теста на хосте (windows 7) подобного костыля не требует."
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Комит <a href="/mst777/zerx_tv/commits/0e59eda" rel="nofollow">0e59eda</a> - <strong>Functional</strong> тесты со стороны витрины</p>
<p>Запуск на виртуальной машине :</p>
<div class="codehilite language-text"><pre><span></span>cd /vagrant
./vendor/phpunit/phpunit/phpunit tests/site/php/functional/orders/OrdersFunctionalTest.php
</pre></div>


<p>и результат:</p>
<div class="codehilite language-text"><pre><span></span>Time: 2.01 minutes, Memory: 12.00MB
OK (4 tests, 141 assertions)
</pre></div>


<p>Тест \OrdersFunctionalTest::<strong>testProfilePageVotingNonAuth</strong>  имеет костыль. Запуск на VM (selenium + Firefox) видимо игнорирует все вызовы <code>focus()</code>. Поэтому невозможно снятие фокуса с поля Название (например при фокусе на поле Год) при нахождении похожих заказов и соответственно нормальное срабатывание события <code>on('focusout')</code>. В web/assets/site/scripts/components/c-order-table.js:252 был вынужден повесить дополнительный хендлер на клик по полю Год исключительно для теста по похожим заказам. Запуск теста на хосте (windows 7) подобного костыля не требует.</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31942261">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31942261" title="Link directly to this comment">
        <time datetime="2016-11-06T20:21:02+00:00" data-title="true">2016-11-06T20:21:02+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-31986871">
                
                 

<article id="comment-31986871" class="iterable-item"
         data-comment-id="31986871"
         data-convert-markup="False"
         data-content="Комит f10f703 - **Functional** тесты со стороны админ панели

Запуск на виртуальной машине :

```
#!text

cd /vagrant
./vendor/phpunit/phpunit/phpunit tests/backoffice/php/functional/orders/OrdersAdminPanelTest.php
```

и результат:

```
#!text
Time: 1.11 minutes, Memory: 8.00MB
OK (3 tests, 112 assertions)
```

Тест \OrdersFunctionalTest::testProfilePageVotingNonAuth : убрал костыль, описанный [тут](#comment-31942261), добавил для VM (selenium + firefox) среды снятие фокуса с поля Название с пом. JS -  `$this-&gt;runScript(&quot;$('.order-custom-msg-ru').trigger('focusout')&quot;)`"
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Комит <a href="/mst777/zerx_tv/commits/f10f703" rel="nofollow">f10f703</a> - <strong>Functional</strong> тесты со стороны админ панели</p>
<p>Запуск на виртуальной машине :</p>
<div class="codehilite language-text"><pre><span></span>cd /vagrant
./vendor/phpunit/phpunit/phpunit tests/backoffice/php/functional/orders/OrdersAdminPanelTest.php
</pre></div>


<p>и результат:</p>
<div class="codehilite language-text"><pre><span></span>Time: 1.11 minutes, Memory: 8.00MB
OK (3 tests, 112 assertions)
</pre></div>


<p>Тест \OrdersFunctionalTest::testProfilePageVotingNonAuth : убрал костыль, описанный <a href="#comment-31942261">тут</a>, добавил для VM (selenium + firefox) среды снятие фокуса с поля Название с пом. JS -  <code>$this-&gt;runScript("$('.order-custom-msg-ru').trigger('focusout')")</code></p>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/31986871">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-31986871" title="Link directly to this comment">
        <time datetime="2016-11-08T11:26:30+00:00" data-title="true">2016-11-08T11:26:30+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-32140333">
                
                 

<article id="comment-32140333" class="iterable-item"
         data-comment-id="32140333"
         data-convert-markup="False"
         data-content="Одна из подзадач не была выполнена: https://bitbucket.org/mst777/zerx_tv/issues/689/--------------------------#comment-31528059

```
3. Шаблон со столом заказов нужно вынести в отедельный файл, который будет 
содержать действия, которые можно совершить со столом заказов, список заказов и 
модальные окна. Если это сделать, будет удобно подключать этот шаблон как на 
страницу модуля &quot;Стол заказов&quot;, так и на страницу профиля пользователя.

В итоге, должен получиться файл с содержимым типа:

.c-order-table
    .c-order-table__actions
        .c-order_table__action--&lt;action title&gt;
    .c-order-table__list
        .c-order-table__list-item   &lt;---- Добавлено в этом коментарии
    .c-order-table__modal-&lt;modal action 1&gt;
    .c-order-table__modal-&lt;modal action 2&gt;
    ...

Этот файл должен включаться на страницу модуля стола заказов и страницу 
профиля пользователя.
```

Отдельного файла для `.c-order-table` нет.
Слушатели почему-то вешаются на документ:

```javascript
$(document)
    .off('click', '.c-order-table__action-see-order')
    .on('click', '.c-order-table__action-see-order', function (/*e*/) {

```

а должны на элемент, к которому написан скрипт:

```javascript
var $el = $('.c-order-table');

$el
    .off('click', '.c-order-table__action-see-order')
    .on('click', '.c-order-table__action-see-order', function (/*e*/) {

```


---

После исправления, обязательно к ознакомлению:

https://ru.bem.info/methodology/

"
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Одна из подзадач не была выполнена: <a href="https://bitbucket.org/mst777/zerx_tv/issues/689/--------------------------#comment-31528059" rel="nofollow">https://bitbucket.org/mst777/zerx_tv/issues/689/--------------------------#comment-31528059</a></p>
<div class="codehilite"><pre><span></span>3. Шаблон со столом заказов нужно вынести в отедельный файл, который будет 
содержать действия, которые можно совершить со столом заказов, список заказов и 
модальные окна. Если это сделать, будет удобно подключать этот шаблон как на 
страницу модуля &quot;Стол заказов&quot;, так и на страницу профиля пользователя.

В итоге, должен получиться файл с содержимым типа:

.c-order-table
    .c-order-table__actions
        .c-order_table__action--&lt;action title&gt;
    .c-order-table__list
        .c-order-table__list-item   &lt;---- Добавлено в этом коментарии
    .c-order-table__modal-&lt;modal action 1&gt;
    .c-order-table__modal-&lt;modal action 2&gt;
    ...

Этот файл должен включаться на страницу модуля стола заказов и страницу 
профиля пользователя.
</pre></div>


<p>Отдельного файла для <code>.c-order-table</code> нет.
Слушатели почему-то вешаются на документ:</p>
<div class="codehilite language-javascript"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.c-order-table__action-see-order&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.c-order-table__action-see-order&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="cm">/*e*/</span><span class="p">)</span> <span class="p">{</span>
</pre></div>


<p>а должны на элемент, к которому написан скрипт:</p>
<div class="codehilite language-javascript"><pre><span></span><span class="kd">var</span> <span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.c-order-table&#39;</span><span class="p">);</span>

<span class="nx">$el</span>
    <span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.c-order-table__action-see-order&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.c-order-table__action-see-order&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="cm">/*e*/</span><span class="p">)</span> <span class="p">{</span>
</pre></div>


<hr />
<p>После исправления, обязательно к ознакомлению:</p>
<p><a href="https://ru.bem.info/methodology/" rel="nofollow">https://ru.bem.info/methodology/</a></p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-32140333" title="Link directly to this comment">
        <time datetime="2016-11-14T11:25:35+00:00" data-title="true">2016-11-14T11:25:35+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-32166643">
                
                 

<article id="comment-32166643" class="iterable-item"
         data-comment-id="32166643"
         data-convert-markup="False"
         data-content="По условиям из [comment-32140333](https://bitbucket.org/mst777/zerx_tv/issues/689#comment-32140333) объединить все в 1 файл который будет содержать все действия, которые можно совершить со столом заказов итп не могу тк разные места шаблонов используются в разных местах функционала :

* `/orders/view-row.html.twig` используется 1) для вывода списка на самом столе заказов и 2) для вывода похожих заказов в модальном окне подачи заказа. 
* При имеющейся логике (в сайдбаре кликом делается переход на стол заказов, а не открытие окна подачи заказа) можно засунуть шаблон модального окна `orders-modal.html.twig` в базовый шаблон `view-row.html.twig`, однако это только уменьшит кол-во файлов шаблонов с 4 до 3 . 


Если исправить упомянутый слушатель с `components/c-order-table.js:158` как указано в пред. комменте - модальное окно подтверждения заказа **не закроется** при клике на &quot;Просмотреть заказ&quot;, видимо на момент создания заказа оно существует по другому xPath. Комитом 619a938 удалил лишний слушатель с блока голосования, тк убрали окно подтверждения по голосованию, и там соответственно нет линка на &quot;Просмотреть заказ&quot;"
         >
  <header>
      <a href="/yybitb/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/yybitb/avatar/32/?ts=1505382991" alt="">
          </div>
        </div>
      </a>
      <a href="/yybitb/" class="author">yybitb</a>
      
      
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>По условиям из <a href="https://bitbucket.org/mst777/zerx_tv/issues/689#comment-32140333">comment-32140333</a> объединить все в 1 файл который будет содержать все действия, которые можно совершить со столом заказов итп не могу тк разные места шаблонов используются в разных местах функционала :</p>
<ul>
<li><code>/orders/view-row.html.twig</code> используется 1) для вывода списка на самом столе заказов и 2) для вывода похожих заказов в модальном окне подачи заказа. </li>
<li>При имеющейся логике (в сайдбаре кликом делается переход на стол заказов, а не открытие окна подачи заказа) можно засунуть шаблон модального окна <code>orders-modal.html.twig</code> в базовый шаблон <code>view-row.html.twig</code>, однако это только уменьшит кол-во файлов шаблонов с 4 до 3 . </li>
</ul>
<p>Если исправить упомянутый слушатель с <code>components/c-order-table.js:158</code> как указано в пред. комменте - модальное окно подтверждения заказа <strong>не закроется</strong> при клике на "Просмотреть заказ", видимо на момент создания заказа оно существует по другому xPath. Комитом <a href="/mst777/zerx_tv/commits/619a938" rel="nofollow">619a938</a> удалил лишний слушатель с блока голосования, тк убрали окно подтверждения по голосованию, и там соответственно нет линка на "Просмотреть заказ"</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a href="#edit" class="edit-comment-link">Edit</a>
    </li>
    <li>
      <form method="POST" action="/mst777/zerx_tv/issue/delete/689/32166643">
        <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
        <a class="delete-link" href="#comment-delete">
          Delete
        </a>
      </form>
    </li>
    <li>
      <a class="permalink" href="#comment-32166643" title="Link directly to this comment">
        <time datetime="2016-11-15T08:48:53+00:00" data-title="true">2016-11-15T08:48:53+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-32204576">
                
                 

<article id="comment-32204576" class="iterable-item"
         data-comment-id="32204576"
         data-convert-markup="False"
         data-content="Проработав часть стола заказов, передаю задачу с рядом замечаний:

1. Стол заказов у нас принимает заказы с названием на одном языке. Во всех шаблонах есть возможность выводить название на русском и на английском (сайт, админка, модальные окна). Нужно подкорректировать так, чтобы везде упоминалось только одно название.

2. Мной заказу добавлено свойство: он автоматически принимается, когда количество голосов достигнуло указанного лимита. Так сейчас работает фронтенд. Нужно добавить такое же свойство и в слушатель голосов.

3. Порядок отображения заказов

    3.1 В админке: сначала выводятся заказы, которые приняты, но не обработаны (так сотрудник сразу будет понимать, над чем ему нужно работать). Затем заказы в порядке убывания количества голосов. В конце - принятые заказы. Порядок определяется удобством работы.

    3.1 На сайте: сначала заказы в порядке убывания голосов (чтобы подтолкнуть посетителя проголосовать за наиболее популярный фильм), потом принятые заказы, и наконец все остальные (заблокированные)

    В обоих случаях должна быть пагинация (ее я не проверял. Если есть - хорошо, если нет - нужно добавить)

4. Установил количество голосов, необходимое для принятия заказа равным единице. Проголосовал. Зашел в админку, попытался сменить статус с &quot;Новый&quot; на &quot;В обработке&quot;. Получил ошибку в алерте о недостаточности количества голосов для перевода заказа из одного статуса в другой. Возможно будет исправлено при выполнении предыдущих пунктов.

5. Все заголовки в админке перевести с технических (`creator_name`, `comment` etc.) на обычный русский язык. С админкой работают люди! Им непонятно и неудобно! Мы уже не раз сталкивались с этим.

6. Все варианты статуса заказа, которые только можно встретить в коде: &quot;В обработке&quot;, &quot;В работе&quot; и прочее заменить на &quot;Заказ принят&quot;.

Просьба внимательно еще раз просмотреть весь код модуля и убрать лишнее, если есть. Подкоректировать места, к которым я потенциально могу придраться. Довести модуль до состояния &quot;Готов к эксплуатации&quot;."
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Проработав часть стола заказов, передаю задачу с рядом замечаний:</p>
<ol>
<li>
<p>Стол заказов у нас принимает заказы с названием на одном языке. Во всех шаблонах есть возможность выводить название на русском и на английском (сайт, админка, модальные окна). Нужно подкорректировать так, чтобы везде упоминалось только одно название.</p>
</li>
<li>
<p>Мной заказу добавлено свойство: он автоматически принимается, когда количество голосов достигнуло указанного лимита. Так сейчас работает фронтенд. Нужно добавить такое же свойство и в слушатель голосов.</p>
</li>
<li>
<p>Порядок отображения заказов</p>
<p>3.1 В админке: сначала выводятся заказы, которые приняты, но не обработаны (так сотрудник сразу будет понимать, над чем ему нужно работать). Затем заказы в порядке убывания количества голосов. В конце - принятые заказы. Порядок определяется удобством работы.</p>
<p>3.1 На сайте: сначала заказы в порядке убывания голосов (чтобы подтолкнуть посетителя проголосовать за наиболее популярный фильм), потом принятые заказы, и наконец все остальные (заблокированные)</p>
<p>В обоих случаях должна быть пагинация (ее я не проверял. Если есть - хорошо, если нет - нужно добавить)</p>
</li>
<li>
<p>Установил количество голосов, необходимое для принятия заказа равным единице. Проголосовал. Зашел в админку, попытался сменить статус с "Новый" на "В обработке". Получил ошибку в алерте о недостаточности количества голосов для перевода заказа из одного статуса в другой. Возможно будет исправлено при выполнении предыдущих пунктов.</p>
</li>
<li>
<p>Все заголовки в админке перевести с технических (<code>creator_name</code>, <code>comment</code> etc.) на обычный русский язык. С админкой работают люди! Им непонятно и неудобно! Мы уже не раз сталкивались с этим.</p>
</li>
<li>
<p>Все варианты статуса заказа, которые только можно встретить в коде: "В обработке", "В работе" и прочее заменить на "Заказ принят".</p>
</li>
</ol>
<p>Просьба внимательно еще раз просмотреть весь код модуля и убрать лишнее, если есть. Подкоректировать места, к которым я потенциально могу придраться. Довести модуль до состояния "Готов к эксплуатации".</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-32204576" title="Link directly to this comment">
        <time datetime="2016-11-16T11:35:50+00:00" data-title="true">2016-11-16T11:35:50+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-32356179">
                
                 

<article id="comment-32356179" class="iterable-item"
         data-comment-id="32356179"
         data-convert-markup="False"
         data-content="Я закинул на сервер косметические обновления. Из того, что осталось сделать:

1. В админке и на сайте задать название модуля - &quot;order_table&quot;.
2. Добавить новое поле в заказе - идентификатор фильма. Это нужно для того, чтобы когда контентщик выполнит заказ, он вставил идентификатор фильма в это поле. На странице сайта со списком заказов должна быть доступна ссылка на этот фильм. Таким образом, если заказ еще не обработан, выводится только название фильма. Когда заказ обработан, видео загружено и контентщик выставил ID фильма, то на странице со столом заказов название фильма должно быть обернуто в тег `&lt;a href=&quot;...&quot; target=&quot;_blank&quot;&gt;...&lt;/a&gt;`."
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>Я закинул на сервер косметические обновления. Из того, что осталось сделать:</p>
<ol>
<li>В админке и на сайте задать название модуля - "order_table".</li>
<li>Добавить новое поле в заказе - идентификатор фильма. Это нужно для того, чтобы когда контентщик выполнит заказ, он вставил идентификатор фильма в это поле. На странице сайта со списком заказов должна быть доступна ссылка на этот фильм. Таким образом, если заказ еще не обработан, выводится только название фильма. Когда заказ обработан, видео загружено и контентщик выставил ID фильма, то на странице со столом заказов название фильма должно быть обернуто в тег <code>&lt;a href="..." target="_blank"&gt;...&lt;/a&gt;</code>.</li>
</ol>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-32356179" title="Link directly to this comment">
        <time datetime="2016-11-22T15:15:37+00:00" data-title="true">2016-11-22T15:15:37+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-32412039">
                
                 

<article id="comment-32412039" class="iterable-item"
         data-comment-id="32412039"
         data-convert-markup="False"
         data-content="После фикса тестов c939718 я подправил сообщения об ошибках валидации: пользователю сайта вываливалась техническая информация.

Также нашел 2 небольшие проблемы. Обе представлены на снимке:

![Spectacle.a21002.png](https://bitbucket.org/repo/XKoj4q/images/2436050691-Spectacle.a21002.png)

1. Заказ, который уже выполнен, отображается как принятый.

2. Ошибки выводятся сплошной строкой, хотя это список. Вообще выводить список сплошной строкой - плохая практика. (Я глянул на код и мне кажется, что лучше для решения проблемы было бы ввести переменную (массив), которая будет хранить сообщения об ошибках. В случае возникновения ошибки в переменную добавляется ее текст и выбрасывается исключение. В отлове исключения массив с ошибками переводится в json, передается клиенту. У клиента json раскладывается на массив. В модальном окне выводится строка &quot;В форме обнаружены ошибки:&lt;br&gt;&quot; затем аккуратненько отображается список с ошибками, где каждый элемент списка начинается с точки или тире)

По функциональной части претензий нет."
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
  </ul>
  <div class="wiki-content comment-content">
    <p>После фикса тестов <a href="/mst777/zerx_tv/commits/c939718" rel="nofollow">c939718</a> я подправил сообщения об ошибках валидации: пользователю сайта вываливалась техническая информация.</p>
<p>Также нашел 2 небольшие проблемы. Обе представлены на снимке:</p>
<p><img alt="Spectacle.a21002.png" src="https://bitbucket.org/repo/XKoj4q/images/2436050691-Spectacle.a21002.png" /></p>
<ol>
<li>
<p>Заказ, который уже выполнен, отображается как принятый.</p>
</li>
<li>
<p>Ошибки выводятся сплошной строкой, хотя это список. Вообще выводить список сплошной строкой - плохая практика. (Я глянул на код и мне кажется, что лучше для решения проблемы было бы ввести переменную (массив), которая будет хранить сообщения об ошибках. В случае возникновения ошибки в переменную добавляется ее текст и выбрасывается исключение. В отлове исключения массив с ошибками переводится в json, передается клиенту. У клиента json раскладывается на массив. В модальном окне выводится строка "В форме обнаружены ошибки:&lt;br&gt;" затем аккуратненько отображается список с ошибками, где каждый элемент списка начинается с точки или тире)</p>
</li>
</ol>
<p>По функциональной части претензий нет.</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-32412039" title="Link directly to this comment">
        <time datetime="2016-11-24T13:43:19+00:00" data-title="true">2016-11-24T13:43:19+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
              <li class="issue-comment comment" id="comment-32435505">
                
                 

<article id="comment-32435505" class="iterable-item"
         data-comment-id="32435505"
         data-convert-markup="False"
         data-content="close #689: Merge branch 'iss689' into develop

# Conflicts:
#	engine/modules/names.php


→ &lt;&lt;cset bcbf74a6d069&gt;&gt;"
         >
  <header>
      <a href="/icamys/">
        <div class="aui-avatar aui-avatar-medium">
          <div class="aui-avatar-inner">
            <img src="https://bitbucket.org/account/icamys/avatar/32/?ts=1505378342" alt="">
          </div>
        </div>
      </a>
      <a href="/icamys/" class="author">Dmitrii Prisacari</a>
      
      <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle user-issue-lozenge">reporter</span>
      
  </header>
  <ul class="changes">
      <li>
                    changed status to
                    <a href="/mst777/zerx_tv/issues?status=closed">closed</a>
      </li>
  </ul>
  <div class="wiki-content comment-content">
    <p>close <a href="/mst777/zerx_tv/issues/689/--------------------------" rel="nofollow" title="Разработать модуль заказов"><s>#689</s></a>: Merge branch 'iss689' into develop</p>
<h1 id="markdown-header-conflicts">Conflicts:</h1>
<h1 id="markdown-header-enginemodulesnamesphp">engine/modules/names.php</h1>
<p>→ &lt;&lt;cset <a href="/mst777/zerx_tv/commits/bcbf74a6d069" rel="nofollow">bcbf74a6d069</a>&gt;&gt;</p>
  </div>
  <ul class="comment-actions">
    <li>
      <a class="permalink" href="#comment-32435505" title="Link directly to this comment">
        <time datetime="2016-11-25T11:02:34+00:00" data-title="true">2016-11-25T11:02:34+00:00</time>
      </a>
    </li>
  </ul>
</article>

              </li>
            
            
          </ol>
          
            
            
              
    
    
  
            
          
        </div>
      </div>
      <div class="aui-item sidebar">
        <div class="issue-attrs">
          <dl>
            <dt>Assignee</dt>
            <dd class="assignee with-icon">
              
                <a href="/mst777/zerx_tv/issues?responsible=yybitb">
                  <span class="aui-avatar aui-avatar-xsmall">
                    <span class="aui-avatar-inner">
                      <img src="https://bitbucket.org/account/yybitb/avatar/16/?ts=1505382991">
                    </span>
                  </span>
                  yybitb
                </a>
              
            </dd>
          </dl>
          <dl>
            <dt>Type</dt>
            <dd class="type with-icon">
              <a href="/mst777/zerx_tv/issues?kind=enhancement">
                <span class="icon icon-enhancement"></span>
                enhancement
              </a>
            </dd>
          </dl>
          <dl>
            <dt>Priority</dt>
            <dd class="priority with-icon">
              <a href="/mst777/zerx_tv/issues?priority=major">
                <span class="icon icon-major"></span>
                major
              </a>
            </dd>
          </dl>
          <dl>
            <dt>Status</dt>
            <dd class="status">
              <a href="/mst777/zerx_tv/issues?status=closed">
                closed
              </a>
            </dd>
          </dl>
          
          
          
          <dl>
            <dt>Votes</dt>
            <dd class="votes">
              <span id="issue-vote-count" class="aui-badge">0</span>
              
                <a href="/api/1.0/repositories/mst777/zerx_tv/issue/689/vote"
                   id="issue-vote-trigger" class="vote-issue"
                   data-vote-text="Vote for this issue"
                   data-unvote-text="Remove vote"
                   
                     data-voted="false"
                     title="Vote for this issue"> Vote for this issue
                   
                </a>
              
            </dd>
          </dl>
          <dl>
            <dt>Watchers</dt>
            <dd class="watchers">
              <span id="issue-watch-count" class="aui-badge aui-badge-active">1</span>
              
                <a href="/api/1.0/repositories/mst777/zerx_tv/issue/689/follow"
                   id="issue-watch-trigger"
                   class="follow-issue follow following"
                   data-follow-text="Watch this issue"
                   data-unfollow-text="Stop watching"
                    
                   title="Stop watching this issue"> Stop watching
                    
                </a>
              
            </dd>
          </dl>
        </div>
        
          
            
          
        
      </div>
    </div>
  </section>

  </div>

        
        
        
          
    
    
  
        
      </div>
    </div>
    <div id="code-search-cta"></div>
  </div>

      </div>
    </div>
  

  
</div>

  <div id="adg3-dialog"></div>



  

<div data-module="components/mentions/index">
  
    
    
  
  
    
    
  
  
    
    
  
</div>
<div data-module="components/typeahead/emoji/index">
  
    
    
  
</div>

<div data-module="components/repo-typeahead/index">
  
    
    
  
</div>

    
    
  

    
    
  

    
    
  

    
    
  


  <aui-inline-dialog
    id="help-menu-dialog"
    data-aui-alignment="bottom right"

    
    data-aui-alignment-static="true"
    data-module="header/help-menu"
    responds-to="toggle"
    aria-hidden="true">

  <div id="help-menu-section">
    <h1 class="help-menu-heading">Help</h1>

    <form id="help-menu-search-form" class="aui" target="_blank" method="get"
        action="https://support.atlassian.com/customer/search">
      <span id="help-menu-search-icon" class="aui-icon aui-icon-large aui-iconfont-search"></span>
      <input id="help-menu-search-form-input" name="q" class="text" type="text" placeholder="Ask a question">
    </form>

    <ul id="help-menu-links">
      <li>
        <a class="support-ga" data-support-gaq-page="DocumentationHome"
            href="https://confluence.atlassian.com/x/bgozDQ" target="_blank">
          Online help
        </a>
      </li>
      <li>
        <a class="support-ga" data-support-gaq-page="GitTutorials"
            href="https://www.atlassian.com/git?utm_source=bitbucket&amp;utm_medium=link&amp;utm_campaign=help_dropdown&amp;utm_content=learn_git"
            target="_blank">
          Learn Git
        </a>
      </li>
      <li>
        <a id="keyboard-shortcuts-link"
           href="#">Keyboard shortcuts</a>
      </li>
      <li>
        <a class="support-ga" data-support-gaq-page="DocumentationTutorials"
            href="https://confluence.atlassian.com/x/Q4sFLQ" target="_blank">
          Bitbucket tutorials
        </a>
      </li>
      <li>
        <a class="support-ga" data-support-gaq-page="SiteStatus"
            href="https://status.bitbucket.org/" target="_blank">
          Site status
        </a>
      </li>
      <li>
        <a class="support-ga" data-support-gaq-page="Home"
            href="https://support.atlassian.com/bitbucket-cloud/" target="_blank">
          Support
        </a>
      </li>
    </ul>
  </div>
</aui-inline-dialog>
  


  <div class="omnibar" data-module="components/omnibar/index">
    <form class="omnibar-form aui"></form>
  </div>
  
    
    
  
  
    
    
  
  
    
    
  
  
    
    
  




  

  <div class="_mustache-templates">
    
      <script id="transition-dialog-template" type="text/html">
        

<form class="aui" id="issue-transition-form" method="post"
            data-duplicate-url="/mst777/zerx_tv/issue-duplicate/689/">
  <div class="aui-message error hidden">
    <span class="aui-icon icon-error"></span>
    <div class="message"></div>
  </div>

  <div class=" duplicate field-group">
    <label for="id_duplicate_issue">Issue number</label>
    <input type="text" class="text" id="id_duplicate_issue"/>
  </div>
  <div class="comment field-group">
    <label for="id_transition_comment">Comment</label>
    <div class="textarea-preview">
       <textarea id="id_transition_comment" class="bb-mention-input"
          data-mention-url="/xhr/mentions/repositories/mst777/zerx_tv/issues"
          ></textarea>
       <div class="preview-container wiki-content"><!-- loaded via ajax --></div>
       <div class="mask"></div>
    </div>
  </div>
</form>

      </script>
    
      <script id="user-select-template" type="text/html">
        

<div class="aui-avatar aui-avatar-xsmall admin-avatar">
  <div class="aui-avatar-inner">
    <img src="[[avatar]]">
  </div>
</div>
<span>[[display_name]]</span>

      </script>
    
      <script id="attachment-dialog-template" type="text/html">
        

<form class="aui" id="issue-attachment-form" method="post"
      enctype="multipart/form-data"
      action="/mst777/zerx_tv/issue-attachment/689/">
  <div class="aui-message error hidden">
    <span class="aui-icon icon-error"></span>
    <div class="message"></div>
  </div>
  <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />
  <div class="attachment field-group">
    <label for="id_attachments">Attachments</label>
    <input type="file" multiple="multiple" name="attachments" id="id_attachments">
  </div>
  <div class="comment field-group">
    <label for="id_attachment_comment">Comment</label>
    <div class="textarea-preview">
      <textarea id="id_attachment_comment" name="update_comment"/>
      <div class="preview-container wiki-content"><!-- loaded via ajax --></div>
      <div class="mask"></div>
    </div>
  </div>
</form>

      </script>
    
      <script id="new-comment-template" type="text/html">
        
<li class="new-comment">
  <div class="user">
    <div class="aui-avatar aui-avatar-medium">
      <div class="aui-avatar-inner">
        <img src="[[user_avatar_url]]" alt="" />
      </div>
    </div>
  </div>
  <form class="aui top-label editor" action="#">
    <input type="hidden" class="parent_id"/>
    <input type="hidden" class="comment_id"/>
    [[#convert_markup]]
      <div class="warning aui-message convert-markup">
        <span class="aui-icon icon-warning"></span>
        
        This comment is currently being rendered in creole. Editing the comment will cause it to be rendered in <a target="_blank" href="https://confluence.atlassian.com/x/jIAuEg">markdown</a>.
        
      </div>
    [[/convert_markup]]
    <div class="field-group">
      <textarea id="id_new_comment" class="bb-mention-input"
          
          placeholder="What do you want to say?">[[content]]</textarea>
      <div class="preview-container wiki-content"><!-- loaded via ajax --></div>
      <div class="error"></div>
    </div>
    <div class="buttons">
      <button class="aui-button aui-button-primary js-comment-button" type="submit">Comment</button>
      <a href="#" class="cancel">Cancel</a>
      
    </div>
    <div class="mask"></div>
  </form>
</li>

      </script>
    
      <script id="image-upload-template" type="text/html">
        

<form id="upload-image" method="POST"
    
      action="/xhr/mst777/zerx_tv/image-upload/"
    >
  <input type='hidden' name='csrfmiddlewaretoken' value='sQXaNviOK7xmeNV0PkhVoA0RB81i8aIG' />

  <div class="drop-target">
    <p class="centered">Drag image here</p>
  </div>

  
  <div>
    <button class="aui-button click-target">Select an image</button>
    <input name="file" type="file" class="hidden file-target"
           accept="image/jpeg, image/gif, image/png" />
    <input type="submit" class="hidden">
  </div>
</form>


      </script>
    
      <script id="mention-result" type="text/html">
        
<span class="mention-result">
  <span class="aui-avatar aui-avatar-small mention-result--avatar">
    <span class="aui-avatar-inner">
      <img src="[[avatar_url]]">
    </span>
  </span>
  [[#display_name]]
    <span class="display-name mention-result--display-name">[[&display_name]]</span> <small class="username mention-result--username">[[&username]]</small>
  [[/display_name]]
  [[^display_name]]
    <span class="username mention-result--username">[[&username]]</span>
  [[/display_name]]
  [[#is_teammate]][[^is_team]]
    <span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle mention-result--lozenge">teammate</span>
  [[/is_team]][[/is_teammate]]
</span>
      </script>
    
      <script id="mention-call-to-action" type="text/html">
        
[[^query]]
<li class="bb-typeahead-item">Begin typing to search for a user</li>
[[/query]]
[[#query]]
<li class="bb-typeahead-item">Continue typing to search for a user</li>
[[/query]]

      </script>
    
      <script id="mention-no-results" type="text/html">
        
[[^searching]]
<li class="bb-typeahead-item">Found no matching users for <em>[[query]]</em>.</li>
[[/searching]]
[[#searching]]
<li class="bb-typeahead-item bb-typeahead-searching">Searching for <em>[[query]]</em>.</li>
[[/searching]]

      </script>
    
      <script id="emoji-result" type="text/html">
        
<span class="emoji-result">
  <span class="emoji-result--avatar">
    <img class="emoji" src="[[src]]">
  </span>
  <span class="name emoji-result--name">[[&name]]</span>
</span>

      </script>
    
      <script id="repo-typeahead-result" type="text/html">
        <span class="aui-avatar aui-avatar-project aui-avatar-xsmall">
  <span class="aui-avatar-inner">
    <img src="[[avatar]]">
  </span>
</span>
<span class="owner">[[&owner]]</span>/<span class="slug">[[&slug]]</span>

      </script>
    
      <script id="share-form-template" type="text/html">
        

<div class="error aui-message hidden">
  <span class="aui-icon icon-error"></span>
  <div class="message"></div>
</div>
<form class="aui">
  <table class="widget bb-list aui">
    <thead>
    <tr class="assistive">
      <th class="user">User</th>
      <th class="role">Role</th>
      <th class="actions">Actions</th>
    </tr>
    </thead>
    <tbody>
      <tr class="form">
        <td colspan="2">
          <input type="text" class="text bb-user-typeahead user-or-email"
                 placeholder="Username or email address"
                 autocomplete="off"
                 data-bb-typeahead-focus="false"
                 [[#disabled]]disabled[[/disabled]]>
        </td>
        <td class="actions">
          <button type="submit" class="aui-button aui-button-light" disabled>Add</button>
        </td>
      </tr>
    </tbody>
  </table>
</form>

      </script>
    
      <script id="share-detail-template" type="text/html">
        

[[#username]]
<td class="user
    [[#hasCustomGroups]]custom-groups[[/hasCustomGroups]]"
    [[#error]]data-error="[[error]]"[[/error]]>
  <div title="[[displayName]]">
    <a href="/[[username]]/" class="user">
      <span class="aui-avatar aui-avatar-xsmall">
        <span class="aui-avatar-inner">
          <img src="[[avatar]]">
        </span>
      </span>
      <span>[[displayName]]</span>
    </a>
  </div>
</td>
[[/username]]
[[^username]]
<td class="email
    [[#hasCustomGroups]]custom-groups[[/hasCustomGroups]]"
    [[#error]]data-error="[[error]]"[[/error]]>
  <div title="[[email]]">
    <span class="aui-icon aui-icon-small aui-iconfont-email"></span>
    [[email]]
  </div>
</td>
[[/username]]
<td class="role
    [[#hasCustomGroups]]custom-groups[[/hasCustomGroups]]">
  <div>
    [[#group]]
      [[#hasCustomGroups]]
        <select class="group [[#noGroupChoices]]hidden[[/noGroupChoices]]">
          [[#groups]]
            <option value="[[slug]]"
                [[#isSelected]]selected[[/isSelected]]>
              [[name]]
            </option>
          [[/groups]]
        </select>
      [[/hasCustomGroups]]
      [[^hasCustomGroups]]
      <label>
        <input type="checkbox" class="admin"
            [[#isAdmin]]checked[[/isAdmin]]>
        Administrator
      </label>
      [[/hasCustomGroups]]
    [[/group]]
    [[^group]]
      <ul>
        <li class="permission aui-lozenge aui-lozenge-complete
            [[^read]]aui-lozenge-subtle[[/read]]"
            data-permission="read">
          read
        </li>
        <li class="permission aui-lozenge aui-lozenge-complete
            [[^write]]aui-lozenge-subtle[[/write]]"
            data-permission="write">
          write
        </li>
        <li class="permission aui-lozenge aui-lozenge-complete
            [[^admin]]aui-lozenge-subtle[[/admin]]"
            data-permission="admin">
          admin
        </li>
      </ul>
    [[/group]]
  </div>
</td>
<td class="actions
    [[#hasCustomGroups]]custom-groups[[/hasCustomGroups]]">
  <div>
    <a href="#" class="delete">
      <span class="aui-icon aui-icon-small aui-iconfont-remove">Delete</span>
    </a>
  </div>
</td>

      </script>
    
      <script id="share-team-template" type="text/html">
        

<div class="clearfix">
  <span class="team-avatar-container">
    <span class="aui-avatar aui-avatar-medium">
      <span class="aui-avatar-inner">
        <img src="[[avatar]]">
      </span>
    </span>
  </span>
  <span class="team-name-container">
    [[display_name]]
  </span>
</div>
<p class="helptext">
  
    Existing users are granted access to this team immediately.
    New users will be sent an invitation.
  
</p>
<div class="share-form"></div>

      </script>
    
      <script id="scope-list-template" type="text/html">
        <ul class="scope-list">
  [[#scopes]]
    <li class="scope-list--item">
      <span class="scope-list--icon aui-icon aui-icon-small [[icon]]"></span>
      <span class="scope-list--description">[[description]]</span>
    </li>
  [[/scopes]]
</ul>

      </script>
    
      <script id="omnibar-form-template" type="text/html">
        <div class="omnibar-input-container">
  <input class="omnibar-input" type="text" [[#placeholder]]placeholder="[[placeholder]]"[[/placeholder]]>
</div>
<ul class="omnibar-result-group-list"></ul>

      </script>
    
      <script id="omnibar-blank-slate-template" type="text/html">
        

<div class="omnibar-blank-slate">No results found</div>

      </script>
    
      <script id="omnibar-result-group-list-item-template" type="text/html">
        <div class="omnibar-result-group-header clearfix">
  <h2 class="omnibar-result-group-label" title="[[label]]">[[label]]</h2>
  <span class="omnibar-result-group-context" title="[[context]]">[[context]]</span>
</div>
<ul class="omnibar-result-list unstyled-list"></ul>

      </script>
    
      <script id="omnibar-result-list-item-template" type="text/html">
        [[#url]]
  <a href="[[&url]]" class="omnibar-result-label">[[&label]]</a>
[[/url]]
[[^url]]
  <span class="omnibar-result-label">[[&label]]</span>
[[/url]]
[[#context]]
  <span class="omnibar-result-context">[[context]]</span>
[[/context]]

      </script>
    
  </div>




  
    <script nonce="qSJsq9vJwTIhCo24">
  window.__initial_state__ = {"global": {"features": {"pr-merge-sign-off": true, "comment-likes": true, "fast-pr-merges": true, "twofactor-u2f": true, "clone-mirrors": true, "repo-onboarding": true, "require-issue-key": true, "snippets": true, "adg3": true, "fabric-emoji": true, "revert-pull-request": true, "new-dashboard": true, "integrations-page": true, "online-ides": true, "new-signup-flow": true, "fe_word_diff": true, "clonebundles": true, "use-moneybucket": true, "pinned-issue-comments": true, "invitation-matching-email": true, "2017-logos": true, "diff-renames-public": true, "app-passwords": true, "ignore-whitespace-button": true, "trello-boards": true, "atlassian-editor": true, "squash-merge": true, "pr-shared-component": true, "build-status": true, "code-search-cta": true, "projects": true, "evolution": false, "pr-checkout-command": true, "new-features-management": true, "repo-avatar-revival": true, "diff-renames-internal": true, "search-syntax-highlighting": true, "code-search-cta-launch": true, "new-features": true, "promote-bello": true, "search-results-adg3-page": true, "lfs_post_beta": true, "rollout-bello": true, "two-step": true, "bundle-splitting": true}, "locale": "en", "geoip_country": "UA", "targetFeatures": {"pr-merge-sign-off": true, "comment-likes": true, "fast-pr-merges": true, "twofactor-u2f": true, "clone-mirrors": true, "repo-onboarding": true, "require-issue-key": true, "snippets": true, "adg3": true, "fabric-emoji": true, "revert-pull-request": true, "new-dashboard": true, "integrations-page": true, "online-ides": true, "new-signup-flow": true, "fe_word_diff": true, "clonebundles": true, "use-moneybucket": true, "pinned-issue-comments": true, "invitation-matching-email": true, "2017-logos": true, "diff-renames-public": true, "app-passwords": true, "ignore-whitespace-button": true, "trello-boards": true, "atlassian-editor": false, "squash-merge": true, "pr-shared-component": true, "build-status": true, "code-search-cta": true, "projects": true, "evolution": false, "pr-checkout-command": true, "new-features-management": true, "repo-avatar-revival": true, "diff-renames-internal": true, "search-syntax-highlighting": true, "code-search-cta-launch": true, "new-features": true, "promote-bello": true, "search-results-adg3-page": true, "lfs_post_beta": true, "rollout-bello": true, "two-step": true, "bundle-splitting": true}, "isFocusedTask": false, "teams": [], "bitbucketActions": [{"analytics_label": null, "icon_class": "", "badge_label": null, "weight": 100, "url": "/repo/create?owner=mst777", "tab_name": null, "can_display": true, "label": "<strong>Repository<\/strong>", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repository-create-drawer-item", "icon": ""}, {"analytics_label": null, "icon_class": "", "badge_label": null, "weight": 110, "url": "/account/create-team/", "tab_name": null, "can_display": true, "label": "<strong>Team<\/strong>", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "team-create-drawer-item", "icon": ""}, {"analytics_label": null, "icon_class": "", "badge_label": null, "weight": 120, "url": "/account/projects/create?owner=mst777", "tab_name": null, "can_display": true, "label": "<strong>Project<\/strong>", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "project-create-drawer-item", "icon": ""}, {"analytics_label": null, "icon_class": "", "badge_label": null, "weight": 130, "url": "/snippets/new?owner=mst777", "tab_name": null, "can_display": true, "label": "<strong>Snippet<\/strong>", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "snippet-create-drawer-item", "icon": ""}], "targetUser": {"username": "mst777", "website": "", "display_name": "DiMaco mb", "account_id": "557058:8aef176a-e0af-469d-94dc-420e732e1f44", "links": {"self": {"href": "https://bitbucket.org/!api/2.0/users/mst777"}, "html": {"href": "https://bitbucket.org/mst777/"}, "avatar": {"href": "https://bitbucket.org/account/mst777/avatar/32/"}}, "extra": {"has_atlassian_account": true}, "created_on": "2015-03-02T09:39:46.761722+00:00", "is_staff": false, "location": null, "type": "user", "uuid": "{102fbc9b-6b05-444d-b783-fe5fbf7c8001}"}, "isNavigationOpen": true, "path": "/mst777/zerx_tv/issues/689/--------------------------", "focusedTaskBackButtonUrl": "https://bitbucket.org/mst777/zerx_tv/issues?page=12", "currentUser": {"username": "yybitb", "website": "", "display_name": "yybitb", "account_id": "557058:50b49aec-0028-4a41-8874-55077e86133c", "links": {"self": {"href": "https://bitbucket.org/!api/2.0/users/yybitb"}, "html": {"href": "https://bitbucket.org/yybitb/"}, "avatar": {"href": "https://bitbucket.org/account/yybitb/avatar/32/"}}, "extra": {"has_atlassian_account": true}, "created_on": "2014-06-09T11:01:23.433391+00:00", "is_staff": false, "location": null, "type": "user", "uuid": "{d2ee9cfe-6807-4b0b-b199-aec6bc17e1c6}"}}, "repository": {"section": {"connectActions": [], "cloneProtocol": "https", "currentRepository": {"scm": "git", "name": "zerx_tv", "links": {"clone": [{"href": "https://yybitb@bitbucket.org/mst777/zerx_tv.git", "name": "https"}, {"href": "ssh://git@bitbucket.org/mst777/zerx_tv.git", "name": "ssh"}], "self": {"href": "https://bitbucket.org/!api/2.0/repositories/mst777/zerx_tv"}, "html": {"href": "https://bitbucket.org/mst777/zerx_tv"}, "avatar": {"href": "https://bitbucket.org/mst777/zerx_tv/avatar/32/"}}, "full_name": "mst777/zerx_tv", "owner": {"username": "mst777", "website": "", "display_name": "DiMaco mb", "account_id": "557058:8aef176a-e0af-469d-94dc-420e732e1f44", "links": {"self": {"href": "https://bitbucket.org/!api/2.0/users/mst777"}, "html": {"href": "https://bitbucket.org/mst777/"}, "avatar": {"href": "https://bitbucket.org/account/mst777/avatar/32/"}}, "created_on": "2015-03-02T09:39:46.761722+00:00", "is_staff": false, "location": null, "type": "user", "uuid": "{102fbc9b-6b05-444d-b783-fe5fbf7c8001}"}, "type": "repository", "slug": "zerx_tv", "uuid": "{45d80fa9-cf10-45d7-a08b-3e764391c558}"}, "menuItems": [{"analytics_label": "repository.overview", "icon_class": "icon-overview", "badge_label": null, "weight": 100, "url": "/mst777/zerx_tv/overview", "tab_name": "overview", "can_display": true, "label": "Overview", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-overview-link", "icon": "icon-overview"}, {"analytics_label": "repository.source", "icon_class": "icon-source", "badge_label": null, "weight": 200, "url": "/mst777/zerx_tv/src", "tab_name": "source", "can_display": true, "label": "Source", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-source-link", "icon": "icon-source"}, {"analytics_label": "repository.commits", "icon_class": "icon-commits", "badge_label": null, "weight": 300, "url": "/mst777/zerx_tv/commits/", "tab_name": "commits", "can_display": true, "label": "Commits", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-commits-link", "icon": "icon-commits"}, {"analytics_label": "repository.branches", "icon_class": "icon-branches", "badge_label": null, "weight": 400, "url": "/mst777/zerx_tv/branches/", "tab_name": "branches", "can_display": true, "label": "Branches", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-branches-link", "icon": "icon-branches"}, {"analytics_label": "repository.pullrequests", "icon_class": "icon-pull-requests", "badge_label": "0 open pull requests", "weight": 500, "url": "/mst777/zerx_tv/pull-requests/", "tab_name": "pullrequests", "can_display": true, "label": "Pull requests", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-pullrequests-link", "icon": "icon-pull-requests"}, {"analytics_label": "issues", "icon_class": "icon-issues", "badge_label": "36 active issues", "weight": 600, "url": "/mst777/zerx_tv/issues?status=new&status=open", "tab_name": "issues", "can_display": true, "label": "Issues", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-issues-link", "icon": "icon-issues"}, {"analytics_label": "repository.wiki", "icon_class": "icon-wiki", "badge_label": null, "weight": 700, "url": "/mst777/zerx_tv/wiki/", "tab_name": "wiki", "can_display": true, "label": "Wiki", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-wiki-link", "icon": "icon-wiki"}, {"analytics_label": "repository.downloads", "icon_class": "icon-downloads", "badge_label": null, "weight": 800, "url": "/mst777/zerx_tv/downloads/", "tab_name": "downloads", "can_display": true, "label": "Downloads", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-downloads-link", "icon": "icon-downloads"}, {"analytics_label": "site.addon", "icon_class": "aui-iconfont-unfocus", "badge_label": null, "weight": 100, "url": "/mst777/zerx_tv/addon/bitbucket-trello-integration-installer/trello-board", "tab_name": "repopage-74Mgx6-add-on-link", "can_display": true, "label": "Boards", "anchor": false, "analytics_payload": {}, "icon_url": "https://bitbucket-assetroot.s3.amazonaws.com/add-on/icons/35ceae0c-17b1-443c-a6e8-d9de1d7cccdb.svg?Signature=JvXMqB4UL3x88F7ykDBiC3PTFH0%3D&Expires=1505385105&AWSAccessKeyId=AKIAIQWXW6WLXMB5QZAQ&versionId=3oqdrZZjT.HijZ3kHTPsXE6IcSjhCG.P", "type": "connect_menu_item", "id": "repopage-74Mgx6-add-on-link", "target": "_self"}], "bitbucketActions": [{"analytics_label": "repository.clone", "icon_class": "icon-clone", "badge_label": null, "weight": 100, "url": "#clone", "tab_name": "clone", "can_display": true, "label": "<strong>Clone<\/strong> this repository", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-clone-button", "icon": "icon-clone"}, {"analytics_label": "repository.create_branch", "icon_class": "icon-create-branch", "badge_label": null, "weight": 200, "url": "/mst777/zerx_tv/branch", "tab_name": "create-branch", "can_display": true, "label": "Create a <strong>branch<\/strong>", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-create-branch-link", "icon": "icon-create-branch"}, {"analytics_label": "create_pullrequest", "icon_class": "icon-create-pull-request", "badge_label": null, "weight": 300, "url": "/mst777/zerx_tv/pull-requests/new", "tab_name": "create-pullreqs", "can_display": true, "label": "Create a <strong>pull request<\/strong>", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-create-pull-request-link", "icon": "icon-create-pull-request"}, {"analytics_label": "repository.compare", "icon_class": "aui-icon-small aui-iconfont-devtools-compare", "badge_label": null, "weight": 400, "url": "/mst777/zerx_tv/branches/compare", "tab_name": "compare", "can_display": true, "label": "<strong>Compare<\/strong> branches or tags", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-compare-link", "icon": "aui-icon-small aui-iconfont-devtools-compare"}, {"analytics_label": "repository.fork", "icon_class": "icon-fork", "badge_label": null, "weight": 500, "url": "/mst777/zerx_tv/fork", "tab_name": "fork", "can_display": true, "label": "<strong>Fork<\/strong> this repository", "anchor": true, "analytics_payload": {}, "target": "_self", "type": "menu_item", "id": "repo-fork-link", "icon": "icon-fork"}], "activeMenuItem": "issues"}}};
  window.__settings__ = {"SOCIAL_AUTH_ATLASSIANID_LOGOUT_URL": "https://id.atlassian.com/logout", "CANON_URL": "https://bitbucket.org", "API_CANON_URL": "https://api.bitbucket.org"};
</script>
<script src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/jsi18n/en/djangojs.js"></script>

  <script src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/dist/webpack/locales/en.js"></script>

<script src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/dist/webpack/common.js"></script>
<script src="https://d301sr5gafysq2.cloudfront.net/4373ea877c7d/dist/webpack/issues.js"></script>
  


<script async src="https://www.google-analytics.com/analytics.js"></script>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","queueTime":0,"licenseKey":"a2cef8c3d3","agent":"","transactionName":"Z11RZxdWW0cEVkYLDV4XdUYLVEFdClsdAAtEWkZQDlJBGgRFQhFMWUtARgBEG0IMUEURWFlLQEYA","applicationID":"1841284","errorBeacon":"bam.nr-data.net","applicationTime":1101}</script>
</body>
</html>